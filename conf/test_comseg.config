/*
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    Nextflow config file for running minimal tests
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    Defines input files and everything required to run a fast and simple pipeline test.

    Use as follows:
        nextflow run nf-core/sopa -profile test,<docker/singularity> --outdir <OUTDIR>

----------------------------------------------------------------------------------------
*/

process {
    resourceLimits = [
        cpus: 4,
        memory: '15.GB',
        time: '1.h',
    ]
}

params {
    config_profile_name = 'Test profile'
    config_profile_description = 'Minimal test dataset to check pipeline function'

    // Input data
    input = "${baseDir}/tests/samplesheet.csv"

    read.technology = "toy_dataset"


    patchify = [
        patch_width_microns: 400,
        patch_overlap_microns: 20,
    ]

    segmentation.comseg = [
        min_area: 10,
        prior_shapes_key: "cells",
        config: [
            dict_scale: [
                x: 1,
                y: 1,
                z: 1,
            ],
            mean_cell_diameter: 15,
            max_cell_radius: 25,
            allow_disconnected_polygon: false,
            alpha: 0.5,
            min_rna_per_cell: 5,
            gene_column: "genes",
            norm_vector: false,
        ],
    ]

    aggregate = [
        aggregate_channels: true,
        min_transcripts: 5,
    ]

    explorer = [
        ram_threshold_gb: 4,
        pixel_size: 0.1,
    ]
}
