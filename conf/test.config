/*
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    Nextflow config file for running minimal tests
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    Defines input files and everything required to run a fast and simple pipeline test.

    Use as follows:
        nextflow run nf-core/sopa -profile test,<docker/singularity> --outdir <OUTDIR>

----------------------------------------------------------------------------------------
*/

process {
    resourceLimits = [
        cpus: 4,
        memory: '15.GB',
        time: '1.h',
    ]
}

params {
    config_profile_name = 'Test profile with Proseg'
    config_profile_description = 'Minimal test dataset to check pipeline function'

    // Input data
    input = "${baseDir}/tests/samplesheet.csv"

    read = [
        technology: "toy_dataset",
        kwargs: [
            genes: 500
        ],
    ]

    patchify = [
        patch_width_microns: 400,
        patch_overlap_microns: 20,
    ]

    segmentation.proseg.prior_shapes_key = "auto"

    aggregate = [
        aggregate_channels: true,
        min_transcripts: 5,
    ]

    annotation = [
        method: "fluorescence",
        args: [
            marker_cell_dict: [
                CK: "Tumoral cell",
                CD3: "T cell",
                CD20: "B cell",
            ]
        ],
    ]

    explorer = [
        ram_threshold_gb: 4,
        pixel_size: 0.1,
    ]
}
